:root{
  --bg:#f7f7f7; --fg:#222;
  --accent:#3b82f6; --accent-light:#dff0ff;
  --assistant:#e8ffe3;
  --radius:8px;
  font-family:system-ui,sans-serif;
  line-height:1.45;
}
*{box-sizing:border-box;}
body{margin:0;background:var(--bg);color:var(--fg);}

/* ===== Layout ===== */
.layout3{
  display:grid;
  grid-template-columns:240px 1fr 340px;
  grid-template-rows:1fr;
  height:100vh;
  gap:0.75rem;
  padding:0.75rem;
}
.sidebar{
  background:#fff;
  border-radius:var(--radius);
  box-shadow:0 1px 4px rgba(0,0,0,.1);
  padding:.5rem .6rem;
  overflow:auto;
}
.sidebar-head{
  display:flex;justify-content:space-between;align-items:center;
  margin-bottom:.4rem;
}
.sidebar-head h2{margin:0;font-size:1rem;}
.sidebar-head button{
  border:none;background:var(--accent);color:#fff;padding:.25rem .5rem;
  border-radius:4px;cursor:pointer;font-size:.8rem;
}
.project-list{display:flex;flex-direction:column;gap:.25rem;font-size:.85rem;}
.project-item{
  padding:.35rem .45rem;border-radius:4px;cursor:pointer;
  border:1px solid transparent;
}
.project-item:hover{background:var(--accent-light);}
.project-item.active{
  border:1px solid var(--accent);
  background:var(--accent-light);
}
.p-name{font-weight:600;}
.p-path{font-size:.75rem;color:#555;overflow:hidden;text-overflow:ellipsis;}

.chat-panel{
  background:#fff;border-radius:var(--radius);
  box-shadow:0 1px 4px rgba(0,0,0,.1);
  padding:.75rem;display:flex;flex-direction:column;
}
.topbar{
  display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem;
}
.topbar h1{margin:0;font-size:1.1rem;}
.topbar h1 span{color:#666;font-weight:400;font-size:.85rem;}
.actions button{padding:.35rem .7rem;cursor:pointer;border:none;background:#eee;border-radius:4px;}

.messages{
  flex:1;overflow-y:auto;border:1px solid #ddd;border-radius:var(--radius);
  padding:.5rem;background:#fafafa;margin-bottom:.75rem;
}
.msg{margin:.4rem 0;display:flex;flex-direction:column;gap:.1rem;}
.msg .name{font-size:.75rem;color:#555;}
.msg .bubble{
  padding:.5rem .65rem;border-radius:var(--radius);background:#fff;
  box-shadow:0 1px 2px rgba(0,0,0,.06);overflow:auto;
}
.msg.user .bubble{background:var(--accent-light);}
.msg.assistant .bubble{background:var(--assistant);}

.composer{display:flex;gap:.5rem;}
#chat-input{
  flex:1;min-height:3rem;max-height:10rem;resize:vertical;
  padding:.5rem .6rem;border-radius:var(--radius);border:1px solid #ccc;
  font-family:inherit;
}
#send-btn{
  padding:.6rem 1.2rem;border:none;border-radius:var(--radius);
  background:var(--accent);color:#fff;cursor:pointer;
}

.context-panel{
  background:#fff;border-radius:var(--radius);
  box-shadow:0 1px 4px rgba(0,0,0,.1);
  padding:.75rem;overflow:auto;
}
.context-panel h2,.context-panel h3{margin:.4rem 0;}
.ctx-meta.empty,.ctx-readme.empty,.ctx-tree.empty{color:#777;font-style:italic;}
.meta-table{width:100%;border-collapse:collapse;font-size:.85rem;}
.meta-table th,.meta-table td{border:1px solid #ddd;padding:.2rem .4rem;word-break:break-word;}
.meta-table th{background:#f0f0f0;text-align:left;width:90px;}

.tree{list-style:none;padding-left:1rem;font-size:.85rem;}
.tree li.folder::before{content:"üìÅ ";} .tree li.file::before{content:"üìÑ ";}

.trace-box{
  background:#111;color:#eee;padding:.5rem;border-radius:var(--radius);
  max-height:200px;overflow:auto;font-size:.75rem;
}
.small summary{cursor:pointer;}
.mt{margin-top:1rem;}

/* Code block */
pre{position:relative;}
pre.codeblock{padding:0;}
pre.codeblock code{
  display:block;padding:.75rem .9rem .9rem;overflow:auto;white-space:pre;
  background:#2e2e2e;color:#ececec;border-radius:var(--radius);
}
.copy-btn{
  position:absolute;top:6px;right:6px;font-size:.7rem;
  padding:.2rem .45rem;border:none;border-radius:4px;background:#444;color:#fff;cursor:pointer;
}

/* Loading */
.loading{
  position:fixed;inset:0;background:rgba(255,255,255,.65);
  display:flex;align-items:center;justify-content:center;font-size:2rem;z-index:999;
}
.hidden{display:none!important;}

/* Responsive */
@media(max-width:1200px){
  .layout3{grid-template-columns:200px 1fr 280px;}
}
@media(max-width:960px){
  .layout3{
    grid-template-columns:1fr;
    grid-template-rows:auto auto auto;
    height:auto;
  }
  .sidebar{max-height:250px;}
}
